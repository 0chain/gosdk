<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
</head>

<body>
  <div id="hls-play">

  </div>
  <video />

  <!-- https://cdn.jsdelivr.net/gh/golang/go@go1.17.3/misc/wasm/wasm_exec.js -->
  <script src="wasm_exec.js"></script>
  <script>
    const go = new Go();
    WebAssembly.instantiateStreaming(fetch("sdk.wasm"), go.importObject).then((result) => {
      go.run(result.instance);
    });
  </script>

  <script>
      let media_source = new MediaSource();
        media_source.addEventListener('sourceopen', () => {
            console.log("[DEBUG] Event.sourceopen");
            // const mimeCodec = 'video/mp4; codecs="avc1.4dc00d,mp4a.40.2"'; // TODO
            // this.sb = media_source.addSourceBuffer(mimeCodec);
            // this.sb.mode = 'sequence';
        }, false);


        let video = document.getElementsByTagName('video')[0];
        video.src = URL.createObjectURL(media_source);
        video.play();

  </script>
</body>

</html>